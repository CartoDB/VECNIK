<title>Vecnik - Sketch Renderer</title>

<script>
function SketchRender() {
  var RND_FACTOR = 1;
  var rnd = function() {
    return RND_FACTOR * (2*Math.random()-1);
  };

  function sketchLine(context, p0, p1) {
    var
      dx = p1.x-p0.x,
      dy = p1.y-p0.y;

    dx *= 0.15;
    dy *= 0.15;

    for(var i = 0; i < 3; ++i) {
      context.strokeStyle = 'rgba(55, 0, 130, '+ (0.01 + 0.3*Math.random()) +')';
      context.beginPath();
      context.lineWidth = 0.5*(1 + (3-i)) ;//0.3 + rnd();
      context.moveTo(p0.x - dx + rnd(), p0.y - dy + rnd());
      context.lineTo(p1.x + dx + rnd(), p1.y + dy + rnd());
      context.closePath();
      context.stroke();
    }
  }

  var primitive_render = this.primitive_render = {
    Polygon: function(context, coordinates) {
      var c = coordinates;
      var xmin, xmax,ymin, ymax;
      xmin = xmax = c[0].x;
      ymin = ymax = c[0].y;
      //context.shadowColor = 'rgba(0, 0, 0, 0.5)';
      for(var i=1; i < c.length; ++i) {
        context.shadowBlur = 10;
        context.shadowColor = 'rgba(0, 0, 180, 0.6)';
         sketchLine(context, c[i-1], c[i]);
         var p = c[i];
         xmin = Math.min(xmin, p.x);
         xmax = Math.max(xmax, p.x);
         ymin = Math.min(ymin, p.y);
         ymax = Math.max(ymax, p.y);

      }
    },
    LineString: function(context, coordinates) {
      var p = primitive_render.Polygon;
      p(context, coordinates);
    }
  };
}

// SketchRender.prototype = new VECNIK.Renderer();
</script>